<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="SharpNEAT is great library for developing NEAT networks, but unfortunatly is very poorly documented, so I created some boilerplate code to kickstart Your project.
// inputCount - Count of inout neurons // outputCount - Count of output neurons // specimenCount - Specimen count in each generation  var neatGenomeFactory = new NeatGenomeFactory(inputCount, outputCount); var genomeList = neatGenomeFactory.CreateGenomeList(specimenCount, 0); var neatParameters = new NeatEvolutionAlgorithmParameters { SpecieCount = specimenCount }; var distanceMetric = new ManhattanDistanceMetric(); var speciationStrategy = new ParallelKMeansClusteringStrategy&amp;lt;NeatGenome&amp;gt; (distanceMetric); var complexityRegulationStrategy = new NullComplexityRegulationStrategy(); var network = new NeatEvolutionAlgorithm&amp;lt;NeatGenome&amp;gt; (neatParameters, speciationStrategy, complexityRegulationStrategy); var activationScheme = NetworkActivationScheme ." />
<meta name="keywords" content=", NEAT, AI, Tutorial" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/posts/sharpneat-tutorial/" />


    <title>
        
            SharpNEAT Tutorial :: t4ccer 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.66e02c2f30d50da60169f383ffbeb3620799cb81f0e509ddf89b662347f2f2be.css">






<meta itemprop="name" content="SharpNEAT Tutorial">
<meta itemprop="description" content="SharpNEAT is great library for developing NEAT networks, but unfortunatly is very poorly documented, so I created some boilerplate code to kickstart Your project.
// inputCount - Count of inout neurons // outputCount - Count of output neurons // specimenCount - Specimen count in each generation  var neatGenomeFactory = new NeatGenomeFactory(inputCount, outputCount); var genomeList = neatGenomeFactory.CreateGenomeList(specimenCount, 0); var neatParameters = new NeatEvolutionAlgorithmParameters { SpecieCount = specimenCount }; var distanceMetric = new ManhattanDistanceMetric(); var speciationStrategy = new ParallelKMeansClusteringStrategy&lt;NeatGenome&gt; (distanceMetric); var complexityRegulationStrategy = new NullComplexityRegulationStrategy(); var network = new NeatEvolutionAlgorithm&lt;NeatGenome&gt; (neatParameters, speciationStrategy, complexityRegulationStrategy); var activationScheme = NetworkActivationScheme ."><meta itemprop="datePublished" content="2020-05-07T11:39:44&#43;02:00" />
<meta itemprop="dateModified" content="2020-05-07T11:39:44&#43;02:00" />
<meta itemprop="wordCount" content="632"><meta itemprop="image" content="/"/>
<meta itemprop="keywords" content="NEAT,AI,Tutorial," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="SharpNEAT Tutorial"/>
<meta name="twitter:description" content="SharpNEAT is great library for developing NEAT networks, but unfortunatly is very poorly documented, so I created some boilerplate code to kickstart Your project.
// inputCount - Count of inout neurons // outputCount - Count of output neurons // specimenCount - Specimen count in each generation  var neatGenomeFactory = new NeatGenomeFactory(inputCount, outputCount); var genomeList = neatGenomeFactory.CreateGenomeList(specimenCount, 0); var neatParameters = new NeatEvolutionAlgorithmParameters { SpecieCount = specimenCount }; var distanceMetric = new ManhattanDistanceMetric(); var speciationStrategy = new ParallelKMeansClusteringStrategy&lt;NeatGenome&gt; (distanceMetric); var complexityRegulationStrategy = new NullComplexityRegulationStrategy(); var network = new NeatEvolutionAlgorithm&lt;NeatGenome&gt; (neatParameters, speciationStrategy, complexityRegulationStrategy); var activationScheme = NetworkActivationScheme ."/>



    <meta property="og:title" content="SharpNEAT Tutorial" />
<meta property="og:description" content="SharpNEAT is great library for developing NEAT networks, but unfortunatly is very poorly documented, so I created some boilerplate code to kickstart Your project.
// inputCount - Count of inout neurons // outputCount - Count of output neurons // specimenCount - Specimen count in each generation  var neatGenomeFactory = new NeatGenomeFactory(inputCount, outputCount); var genomeList = neatGenomeFactory.CreateGenomeList(specimenCount, 0); var neatParameters = new NeatEvolutionAlgorithmParameters { SpecieCount = specimenCount }; var distanceMetric = new ManhattanDistanceMetric(); var speciationStrategy = new ParallelKMeansClusteringStrategy&lt;NeatGenome&gt; (distanceMetric); var complexityRegulationStrategy = new NullComplexityRegulationStrategy(); var network = new NeatEvolutionAlgorithm&lt;NeatGenome&gt; (neatParameters, speciationStrategy, complexityRegulationStrategy); var activationScheme = NetworkActivationScheme ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/sharpneat-tutorial/" /><meta property="og:image" content="/"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-07T11:39:44&#43;02:00" />
<meta property="article:modified_time" content="2020-05-07T11:39:44&#43;02:00" /><meta property="og:site_name" content="t4ccer" />







    <meta property="article:published_time" content="2020-05-07 11:39:44 &#43;0200 CEST" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">t4ccer/blog</span>
            <span class="logo__cursor" style=
                  "
                   background-color: #00aeff;
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts/">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>3 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="/posts/sharpneat-tutorial/">SharpNEAT Tutorial</a>
            </h1>

            

            <div class="post-content">
                <p><a href="https://github.com/colgreen/sharpneat">SharpNEAT</a> is great library for developing <a href="https://en.wikipedia.org/wiki/Neuroevolution_of_augmenting_topologies">NEAT</a> networks, but unfortunatly is very poorly documented, so I created some boilerplate code to kickstart Your project.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#75715e">// inputCount - Count of inout neurons
</span><span style="color:#75715e">// outputCount - Count of output neurons
</span><span style="color:#75715e">// specimenCount - Specimen count in each generation
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> neatGenomeFactory = <span style="color:#66d9ef">new</span> NeatGenomeFactory(inputCount, outputCount);
<span style="color:#66d9ef">var</span> genomeList = neatGenomeFactory.CreateGenomeList(specimenCount, <span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">var</span> neatParameters = <span style="color:#66d9ef">new</span> NeatEvolutionAlgorithmParameters
{
    SpecieCount = specimenCount
};

<span style="color:#66d9ef">var</span> distanceMetric = <span style="color:#66d9ef">new</span> ManhattanDistanceMetric();
<span style="color:#66d9ef">var</span> speciationStrategy = <span style="color:#66d9ef">new</span> ParallelKMeansClusteringStrategy&lt;NeatGenome&gt;
    (distanceMetric);

<span style="color:#66d9ef">var</span> complexityRegulationStrategy = <span style="color:#66d9ef">new</span> NullComplexityRegulationStrategy();

<span style="color:#66d9ef">var</span> network = <span style="color:#66d9ef">new</span> NeatEvolutionAlgorithm&lt;NeatGenome&gt;
    (neatParameters, speciationStrategy, complexityRegulationStrategy);

<span style="color:#66d9ef">var</span> activationScheme = NetworkActivationScheme
    .CreateCyclicFixedTimestepsScheme(<span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">var</span> genomeDecoder = <span style="color:#66d9ef">new</span> NeatGenomeDecoder(activationScheme);

<span style="color:#66d9ef">var</span> phenomeEvaluator = <span style="color:#66d9ef">new</span> YourPhenomeEvaluator();
<span style="color:#66d9ef">var</span> genomeListEvaluator = 
    <span style="color:#66d9ef">new</span> ParallelGenomeListEvaluator&lt;NeatGenome, IBlackBox&gt;
        (genomeDecoder, phenomeEvaluator, parallelOptions);

network.Initialize(genomeListEvaluator, neatGenomeFactory, genomeList);

<span style="color:#75715e">//Optional
</span><span style="color:#75715e"></span>network.UpdateScheme = <span style="color:#66d9ef">new</span> UpdateScheme(logRate);
network.UpdateEvent += Ea_UpdateEvent;

network.StartContinue();
<span style="color:#66d9ef">while</span> (network.RunState != RunState.Paused)
{
    Thread.Sleep(<span style="color:#ae81ff">100</span>);
}
network.Stop();
</code></pre></div><p>I know, it looks complicated, but let explain it line by line.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> neatGenomeFactory = <span style="color:#66d9ef">new</span> NeatGenomeFactory(inputCount, outputCount);
</code></pre></div><p>At first, create factory for initial population with specified input and output neurons.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> genomeList = neatGenomeFactory.CreateGenomeList(specimenCount, <span style="color:#ae81ff">0</span>);
</code></pre></div><p>Then, create initial genome list with length of <code>specimenCount</code> and first generation number <code>0</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> neatParameters = <span style="color:#66d9ef">new</span> NeatEvolutionAlgorithmParameters
{
    SpecieCount = specimenCount
};
</code></pre></div><p>Here create parameters for your network. Absolute minimum that you have to provide is specimen count in each generation. It should be the same as length of <code>genomeList</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> distanceMetric = <span style="color:#66d9ef">new</span> ManhattanDistanceMetric();
<span style="color:#66d9ef">var</span> speciationStrategy = <span style="color:#66d9ef">new</span> ParallelKMeansClusteringStrategy&lt;NeatGenome&gt;
    (distanceMetric);
</code></pre></div><p>Here things start to be a bit kore tricky. To create <a href="http://en.wikipedia.org/wiki/K-means_clustering">k-means clustering method</a> You must provide <code>IDistanceMetric</code>. I used <code>ManhattanDistanceMetric</code>. About various types of distance metrics You can read <a href="https://medium.com/analytics-vidhya/various-types-of-distance-metrics-machine-learning-cc9d4698c2da">here</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> complexityRegulationStrategy = <span style="color:#66d9ef">new</span> NullComplexityRegulationStrategy();
</code></pre></div><p>Complexity regulation strategies reguletes if Your network tend to be more simple or more complex. <code>NullComplexityRegulationStrategy</code> is just strategy that is fixed to complexifying your network. In my cases it worked best.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> network = <span style="color:#66d9ef">new</span> NeatEvolutionAlgorithm&lt;NeatGenome&gt;
    (neatParameters, speciationStrategy, complexityRegulationStrategy);
</code></pre></div><p><code>NeatEvolutionAlgorithm&lt;NeatGenome&gt;</code> is just fancy word for your neural network. Just provide already created objects and let sharpneat do magic.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> activationScheme = NetworkActivationScheme
    .CreateCyclicFixedTimestepsScheme(<span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">var</span> genomeDecoder = <span style="color:#66d9ef">new</span> NeatGenomeDecoder(activationScheme);
</code></pre></div><p>To create <code>genomeDecoder</code> you have to create <code>activationScheme</code> first.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> phenomeEvaluator = <span style="color:#66d9ef">new</span> YourPhenomeEvaluator();
</code></pre></div><p>At this moment You have to write your first own code. You have to create class that can score fitness of your network.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">YourPhenomeEvaluator</span> : IPhenomeEvaluator&lt;IBlackBox&gt;
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">ulong</span> EvaluationCount =&gt; <span style="color:#ae81ff">0</span>;

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> StopConditionSatisfied =&gt; shouldEnd;
    <span style="color:#66d9ef">bool</span> shouldEnd = <span style="color:#66d9ef">false</span>;
    <span style="color:#66d9ef">public</span> FitnessInfo Evaluate(IBlackBox phenome)
    {
        <span style="color:#75715e">//phenome.InputSignalArray[index] - input neuron array
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//phenome.OutputSignalArray[index] - output neuron array
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> FitnessInfo(fitness, fitness);
    }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Reset() { }
}
</code></pre></div><p>What <code>IPhenomeEvaluator</code> should do is quite obvious but let explain it too.</p>
<p><code>EvaluationCount</code> is count of all evaluations of Your network(You don&rsquo;t have to implement this unless you want to use it).</p>
<p>When <code>StopConditionSatisfied</code> returns <code>true</code> training of Your network stops. Very usefull if e.g. network achieved maximum fitness.</p>
<p><code>Evaluate</code> Method takes network as an input and returns its fitness.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">var</span> genomeListEvaluator = 
    <span style="color:#66d9ef">new</span> ParallelGenomeListEvaluator&lt;NeatGenome, IBlackBox&gt;
        (genomeDecoder, phenomeEvaluator, parallelOptions);
</code></pre></div><p><code>genomeListEvaluator</code> is able to evaluate whole list of genoms, using your phenome evaluator.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">network.Initialize(genomeListEvaluator, neatGenomeFactory, genomeList);
</code></pre></div><p>Initialize alread created network with <code>genomeListEvaluator</code>, <code>neatGenomeFactory</code> and <code>genomeList</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#75715e">//Optional
</span><span style="color:#75715e"></span>network.UpdateScheme = <span style="color:#66d9ef">new</span> UpdateScheme(logRate);
network.UpdateEvent += Ea_UpdateEvent;
</code></pre></div><p>Each <code>logRate</code> generations <code>Ea_UpdateEvent</code> will be called.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">void</span> Ea_UpdateEvent(<span style="color:#66d9ef">object</span> sender, EventArgs e)
{
    <span style="color:#66d9ef">var</span> network = (NeatEvolutionAlgorithm&lt;NeatGenome&gt;)sender;
    Console.WriteLine(<span style="color:#e6db74">$&#34;Generation={network.CurrentGeneration} 
</span><span style="color:#e6db74">        bestFitness={network.Statistics._maxFitness:N6} 
</span><span style="color:#e6db74">        meanFitness={network.Statistics._meanFitness:N6}&#34;</span>);
}
</code></pre></div><p><code>Ea_UpdateEvent</code> can e.g. print network progress.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">network.StartContinue();
</code></pre></div><p>Start your network</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">while</span> (network.RunState != RunState.Paused)
{
    Thread.Sleep(<span style="color:#ae81ff">100</span>);
}
network.Stop();
</code></pre></div><p>Wait untill network is paused(e.g. when <code>YourPhenomeEvaluator.StopConditionSatisfied</code> returns <code>true</code>). Training runs in another thread so You have to block main thred, otherwise program will exit.</p>
<p>Those settings worked best for me, it won&rsquo;t be optimal for every project so don&rsquo;t worry to experiment with settings and parameters on your own.</p>
<p>I hope it will halp You creating Your own awesome machine learning project.</p>
<p>NOTE: I&rsquo;m not a professional data scientist.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/neat">NEAT</a></span><span class="tag"><a href="/tags/ai">AI</a></span><span class="tag"><a href="/tags/tutorial">Tutorial</a></span>
                </p>

            
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="/posts/dister32-part1/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Dister32 - Part 1</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="/posts/dashai-geometry-dash-ai-using-neat/">
                                <span class="button__text">DashAI - Geometry Dash AI using NEAT</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>copyright by t4ccer</span>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.59ecdc8ddd50b30e6dd7ad4a5372c3fd24a26db671cc1575443b150ceb9d4bc8e73618fb298596b5c336cf5d8c2db90bd7e72a648479e97884e5398722f962fa.js" integrity="sha512-Wezcjd1Qsw5t161KU3LD/SSibbZxzBV1RDsVDOudS8jnNhj7KYWWtcM2z12MLbkL1&#43;cqZIR56XiE5TmHIvli&#43;g=="></script>



    </body>
</html>
