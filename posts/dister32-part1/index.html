<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Introduction Dister32 is my own projects for easy managment of distributed computing on cheap but powerful microcontroller ESP32. ESP32 has built-in wifi module so communication between modules will be fairly simple.
ESP-32s module
The article will be split into 3 parts.
In the first part, I will describe how the cluster will work and implement the simplest features. The second part will be published when ordered PCBs will arrive at me." />
<meta name="keywords" content=", Dister, ESP32" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/posts/dister32-part1/" />


    <title>
        
            Dister32 - Part 1 :: t4ccer 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.66e02c2f30d50da60169f383ffbeb3620799cb81f0e509ddf89b662347f2f2be.css">






<meta itemprop="name" content="Dister32 - Part 1">
<meta itemprop="description" content="Introduction Dister32 is my own projects for easy managment of distributed computing on cheap but powerful microcontroller ESP32. ESP32 has built-in wifi module so communication between modules will be fairly simple.
ESP-32s module
The article will be split into 3 parts.
In the first part, I will describe how the cluster will work and implement the simplest features. The second part will be published when ordered PCBs will arrive at me."><meta itemprop="datePublished" content="2020-05-12T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-05-12T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="517"><meta itemprop="image" content="/"/>
<meta itemprop="keywords" content="Dister,ESP32," />





<meta property="twitter:description" content="">
<meta property="twitter:title" content="Dister32 - Part 1">

<meta property="twitter:image" content="//img/t4logo.png">




<meta property="og:title" content="Dister32 - Part 1">

<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-05-12">

<meta property="og:description" content="">
<meta property="og:url" content="/posts/dister32-part1/">
<meta property="og:site_name" content="t4ccer">

<meta property="og:image" content="//img/t4logo.png">


<meta property="og:tags" content="Dister">

<meta property="og:tags" content="ESP32">







    <meta property="article:published_time" content="2020-05-12 00:00:00 &#43;0000 &#43;0000" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">t4ccer/blog</span>
            <span class="logo__cursor" style=
                  "
                   background-color: #00aeff;
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts/">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>3 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="/posts/dister32-part1/">Dister32 - Part 1</a>
            </h1>

            

            <div class="post-content">
                <h3 id="introduction">Introduction</h3>
<p>Dister32 is my own projects for easy managment of distributed computing on cheap but powerful microcontroller <a href="https://www.espressif.com/en/products/socs/esp32/overview">ESP32</a>. ESP32 has built-in wifi module so communication between modules will be fairly simple.</p>
<p><img src="/img/Dister32_1/esp32.png" alt="ESP32">
ESP-32s module</p>
<p>The article will be split into 3 parts.<br>
In the first part, I will describe how the cluster will work and implement the simplest features. The second part will be published when ordered PCBs will arrive at me. And last, third part will describe finished project and then I will publish sourcecode for nodes, master, and dashboard. Also in the last part, I will provide all necessary instructions to create own ESP32 cluster.</p>
<p>At first, let me explain some concepts:</p>
<ul>
<li>Node - is an esp32 module connected to MQTT broker.</li>
<li>Master - is a server connected to MQTT broker that manages nodes and images.</li>
<li>Image - is a compiled, binary program for node.</li>
<li>Pool - is a group of nodes running the same image.</li>
</ul>
<p>Cluster will work using <a href="http://mqtt.org/">MQTT</a> protocole to communicate with master server, and json to serialize data.</p>
<h3 id="node">Node</h3>
<p>Node is ESP32 microcontroller that runs dister32-compatible image. Each node is connected to mqtt broker via WiFi. Name of node is its MAC address without colons. Each node is described by its name, IP address, status (<code>OK</code>/<code>Error</code>/<code>Uploading</code>) and current image. Also, each node is running <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/ota.html">OTA</a> mechanism, therefore, its possible to update its firmware wirelessly.</p>
<h3 id="master">Master</h3>
<p>Master server manages nodes and pools. Master also provides HTTP REST API so it&rsquo;s easy to create a web dashboard(I&rsquo;ll try to create it soon).</p>
<h3 id="pool">Pool</h3>
<p>Pool has assigned image, nodes and count of active nodes. Master is making that exactly <code>count of active nodes</code> nodes will run assigned image. The rest of nodes will be inactive and ready to work if any of running node disconnects.</p>
<h3 id="features">Features</h3>
<ul>
<li>
<p>Welcome messages. Node on boot sends its properties(name, image, etc) with topic <code>dister32/NODE_NAME/welcome</code>. The same message is sent when node receives message with topic <code>dister32/NODE_NAME/introduce</code>.</p>
</li>
<li>
<p>Heartbeat. Master every <code>delay</code> milliseconds  sends message with topic <code>dister32/master/heartbeat/request</code>. Each node has to respond with <code>dister32/NODE_NAME/heartbeat/response</code>. If doesn&rsquo;t after <code>2*delay</code> ms its status is changed to <code>Error</code>. If master receives response from node that is not registered in cluster, master sends <code>dister32/NODE_NAME/introduce</code> message to get info about this node.</p>
</li>
<li>
<p>LED control. ESP32 has built-in LED so let&rsquo;s use it. Node can be in one of 3 states(<code>On</code>/<code>Off</code>/<code>Blink</code>). When node receives message <code>dister32/NODE_NAME/led</code> with content corresponding  to LED mode, it changes its led to that mode.</p>
</li>
</ul>
<h3 id="pcb">PCB</h3>
<p>To easily stack multiple ESP32 nodes I designed simple PCB, with power connectors and female goldpins for esp module. I designed PCB using <a href="https://easyeda.com/">EasyEDA</a> software and ordered on <a href="https://jlcPCB.com/">JLCPCB</a>. PCB is 6x6cm with 3mm holes on each corner, with 5mm from edge to center of the hole.</p>
<p><img src="/img/Dister32_1/pcb1.png" alt="PCB"></p>
<p>I will publish the next part when PCBs arrive at me(it can take a little, I live in Europe).</p>
<p>If you want, for any reason, create your own cluster, I will publish all gerber files, source code, schematics, and tutorials when I publish the last part.</p>
<p>Note: Project is made just for fun, do not use in any serious environment.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/dister">Dister</a></span><span class="tag"><a href="/tags/esp32">ESP32</a></span>
                </p>

            
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="/posts/noisy-art/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Noisy Art - Images using noise</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="/posts/sharpneat-tutorial/">
                                <span class="button__text">SharpNEAT Tutorial</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>copyright by t4ccer</span>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.59ecdc8ddd50b30e6dd7ad4a5372c3fd24a26db671cc1575443b150ceb9d4bc8e73618fb298596b5c336cf5d8c2db90bd7e72a648479e97884e5398722f962fa.js" integrity="sha512-Wezcjd1Qsw5t161KU3LD/SSibbZxzBV1RDsVDOudS8jnNhj7KYWWtcM2z12MLbkL1&#43;cqZIR56XiE5TmHIvli&#43;g=="></script>



    </body>
</html>
